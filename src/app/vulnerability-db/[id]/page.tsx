import ArticleDetail from '@/app/vulnerability-db/_components/ArticleDetail';
import { Report } from '@/components/Chatbot/Chatbot';
import { FloatingButton } from '@/components/Floating/FloatingButton';
import LogoLoading from '@/components/common/Loading/LogoLoading';
import { DetailResponse } from '@/types/crawlingData';
import { Suspense } from 'react';

export default async function VulnerabilityDbDetailPage({ params }: { params: { id: string } }) {
  const detailResponse: DetailResponse = await (
    await fetch(`${process.env.NEXT_PUBLIC_API_URL}/api/vulDb/${params.id}`, {
      cache: 'no-cache',
    })
  ).json();
  const ChatBotReport: Report = {
    title: detailResponse.articleDetailData.title,
    desc: detailResponse.articleDetailData.content,
  };
  return (
    <Suspense fallback={<LogoLoading />}>
      <div className="mt-[3.301rem] flex flex-col items-center">
        <ArticleDetail {...detailResponse} />
        <FloatingButton type="ask" report={ChatBotReport} />
      </div>
    </Suspense>
  );
}
